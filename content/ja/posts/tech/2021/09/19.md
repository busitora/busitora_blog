---
author: "Hugo Authors"
title: 達人に学ぶDB設計徹底指南書
date: 2021-09-19T12:04:06+09:00
description: DB本の感想と要約をします
draft: false
hideToc: false
enableToc: true
enableTocContent: false
author: ブシトラ
authorEmoji: 🐯
tags:
- book
- review
image: images/db/db-sinansho.jpg
---

## はじめに

DB設計を、基礎からもう一度学んで
みたいと思い[達人に学ぶDB設計徹底指南書](https://amzn.to/2XDtXxM)を購入。

自分用メモで気づきメインで書くので、
詳しく知りたい人は購入することを推奨。

## 1章 データベースを制する者はシステムを制す
### データベース(DBMS)の代表的モデル

* RDB(リレーショナルデータベース)
* OODB(オブジェクト指向データベース)
* XMLDB(XMLデータベース)
* KVS(キーバリューストア型)
* HD(階層型データベース)
### ODAとPOA

DOA(data oriented approach) → データ中心アプローチ
POA(process oriented approach) → プロセス中心アプローチ
最初にデータがある。その次にプログラミングがある
### 3層スキーマ

* 外部スキーマ → ユーザーから見たデータベース
* 概念スキーマ → 開発者から見たデータベース
* 内部スキーマ → DBMSから見たデータベース
### 感想

データ設計で苦しむのは実務でも経験した。
実際にDBを作成したあとに追加依頼が入ることもあるので、
追加改修に応えられるようその都度ベストな設計をしていっても
現実そうならないこともあるよな。。

## 2章 論理設計と物理設計
### 論理設計のステップ

1. エンティティの抽出(物理的実体を伴う必要はない)
2. エンティティの定義(列(attributes)を決める)
3. 正規化
4. ER図の作成
### 物理設計のステップ

1. テーブル定義(概念スキーマ毎にテーブルを作成)
2. インデックス定義
3. [ハードウェアのサイジング](http://www.code-magagine.com/?p=1725)(該当システムで処理されうるデータサイズを見積もって、「十分な容量のストレージ（記憶装置）を決める」)
4. ストレージの冗長構成決定
5. ファイルの物理配置決定

```
RAID0→ 異なるディスクに「別々に」保存
RAID1→ 異なるディスクに「同じものを」保存
RAID5→ 3本で保存、1つまでなら壊れても可
RAID10 → RAID1とRAID0の組み合わせだが、コストが高い
```
{{< alert theme="info" >}}
RAIDに関してはとりあえず、少なくても`RAID5`。余裕があれば`RAID10`
{{< /alert >}}

### バックアップ設計

```
フルバックアップ
欠点1 → 時間が長い
欠点2 → ハードウェアリソースへの負荷が高い
欠点3 → サービス停止が必要

差分バックアップ
欠点 → 差分とフルバックアップの2つがあるので、その分手間
利点 → 早い。バックアップ量が減る

増分バックアップ
欠点 → リカバリの際に一番たいへん
利点 →  早い。バックアップ量が減る
```

{{< alert theme="info" >}}
バックアップ方式は、 フルバックアップに増分or差分がヨシ
{{< /alert >}}


### 感想

ハードウェアのサイジングは、必要十分なストレージサイズにする必要があるので、「ある程度余裕を持たせたストレージ容量にしておく」か「簡単に、ストレージの容量を追加できるような構成にしておく」のがよさそう。
スケーラビリティが高いというやつ。

関係ないけど、パズドラで以前[ヘラ杯ロールバック事件](https://togetter.com/li/1106638)合った時、あれは何バックアップだったんだろう。笑


## 3章 論理設計と正規化~なぜテーブルは分割する必要があるのか？
## 4章 ER図~複数のテーブルの関係を表現する
## 5章 論理設計とパフォーマンス~正規化の欠点と非正規化
## 6章 データベースとパフォーマンス
## 7章 論理設計のバッドノウハウ
## 8章 論理設計のグレーノウハウ
## 9章 一歩進んだ論理設計~SQLで木構造を扱う
## 総評
